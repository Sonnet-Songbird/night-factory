<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="description" content="Anime Template">
    <meta name="keywords" content="Anime, unica, creative, html">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>QNA</title>

    <!-- Google Font -->
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Mulish:wght@300;400;500;600;700;800;900&display=swap"
          rel="stylesheet">

    <link rel="stylesheet" href="/webjars/bootstrap/4.5.0/css/bootstrap.min.css" />

    <!-- Css Styles -->
    <link rel="stylesheet" href="../css/bootstrap.min.css" type="text/css">
    <link rel="stylesheet" href="../css/font-awesome.min.css" type="text/css">
    <link rel="stylesheet" href="../css/elegant-icons.css" type="text/css">
    <link rel="stylesheet" href="../css/plyr.css" type="text/css">
    <link rel="stylesheet" href="../css/nice-select.css" type="text/css">
    <link rel="stylesheet" href="../css/owl.carousel.min.css" type="text/css">
    <link rel="stylesheet" href="../css/slicknav.min.css" type="text/css">
    <link rel="stylesheet" href="../css/style.css" type="text/css">
    <link rel="stylesheet" href="../css/post.css" type="text/css">

    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
</head>
<body>

<div id="preloder">
    <div class="loader"></div>
</div>

<header>
    <div th:insert="~{header.html}"></div>
</header>

<div class="title">
    <p style="color: #a83636; text-align: center; font-size: 3rem; font-weight: 700; padding: 100px">QNA</p>

</div>

<div class="content">
    <form action="/post" method="post">
        <div class="form-group row">
            <label for="inputTitle" class="col-sm-2 col-form-label"><strong>제목</strong></label>
            <div class="col-sm-10">
                <input type="text" name="title" class="form-control" id="inputTitle" />
            </div>
        </div>
        <div class="form-group row">
            <label for="inputAuthor" class="col-sm-2 col-form-label"><strong>작성자</strong></label>
            <div class="col-sm-10">
                <input type="text" name="author" class="form-control" id="inputAuthor" />
            </div>
        </div>
        <div class="form-group row">
            <label for="inputContent" class="col-sm-2 col-form-label"><strong>내용</strong></label>
            <div class="col-sm-10">
                <textarea type="text" name="content" class="form-control" id="inputContent" style="height: 300px"></textarea>
            </div>
        </div>
        <div class="row">
            <div class="col-auto mr-auto"></div>
            <div class="col-auto">
                <input class="btn btn-primary" type="button" role="button" value="저장하기" />
            </div>
        </div>
    </form>
</div>

<div th:insert="~{footer.html}"></div>

<div class="search-model">
    <div class="h-100 d-flex align-items-center justify-content-center">
        <div class="search-close-switch"><i class="icon_close"></i></div>
        <form class="search-model-form">
            <input type="text" id="search-input" placeholder="Search here.....">
        </form>
    </div>
</div>


    <script>
        $(document).ready(function () {
        // 저장 버튼 클릭 시
        var isProcessing = false; // 처리 중인지 여부를 나타내는 플래그

        $(".btn.btn-primary").click(function () {
        // 이미 처리 중이면 더 이상의 요청을 막음
        if (isProcessing) {
        return;
    }

        // boardDto에 대한 데이터를 수집
        var boardData = {
        title: $("#inputTitle").val(),
        author: $("#inputAuthor").val(),
        content: $("#inputContent").val()
    };

        // Ajax 요청을 보냅니다.
        $.ajax({
        type: "POST",
        url: "/save",
        data: boardData,
        beforeSend: function () {
        // Ajax 요청을 보내기 전에 처리 중 플래그를 true로 설정
        isProcessing = true;
    },
        success: function (response) {
        alert("게시글이 성공적으로 저장되었습니다.");
        window.location.href = "/list"
    },
        error: function (xhr, status, error) {
        // Ajax 요청 실패 시 처리
        if (xhr.status === 400) {
        // 서버에서 400 에러를 보낸 경우 (빈 칸이 있는 경우)
        alert("게시글, 작성자, 제목을 모두 작성해주세요");
            window.location.href = "redirect: /post"
    } else {
        // 그 외의 경우는 에러 메시지만 출력
        console.error("서버 오류: " + xhr.responseText);
    }
    },
        complete: function () {
        // Ajax 요청 완료 후 처리 중 플래그를 false로 설정
        isProcessing = false;
    }
    });
    });
    });
</script>







<script src="../js/jquery-3.3.1.min.js"></script>
<script src="../js/bootstrap.min.js"></script>
<script src="../js/player.js"></script>
<script src="../js/jquery.nice-select.min.js"></script>
<script src="../js/mixitup.min.js"></script>
<script src="../js/jquery.slicknav.js"></script>
<script src="../js/owl.carousel.min.js"></script>
<script src="../js/main.js"></script>
<script src="../js/faq.js"></script>
<script src="../webjars/jquery/3.5.1/jquery.min.js"></script>
<script src="../webjars/bootstrap/4.5.0/js/bootstrap.min.js"></script>

<script src="/webjars/jquery/3.5.1/jquery.min.js"></script>
<script src="/webjars/bootstrap/4.5.0/js/bootstrap.min.js"></script>
</body>
</html>